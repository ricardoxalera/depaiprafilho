<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Natália - IA com Voz</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; background: #f4f4f4; }
    .chatbox { background: white; padding: 1rem; border-radius: 10px; max-width: 600px; margin: auto; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    button { margin-top: 1rem; padding: 10px 20px; font-size: 16px; cursor: pointer; }
  </style>
</head>
<body>
  <div class="chatbox">
    <h2>👩‍⚕️ Natália - Sua Consultora Natural</h2>
    <p id="output">Clique em "Falar" para começar a conversar comigo por voz.</p>
    <button onclick="startRecognition()">🎡️ Falar</button>
  </div>

  <script>
    const synth = window.speechSynthesis;
    const output = document.getElementById('output');

    function speak(text) {
      const utter = new SpeechSynthesisUtterance(text);
      utter.lang = 'pt-BR';

      let voices = synth.getVoices();
      if (!voices.length) {
        synth.onvoiceschanged = () => {
          utter.voice = synth.getVoices().find(voice => voice.lang === 'pt-BR');
          synth.speak(utter);
        };
        return;
      }

      utter.voice = voices.find(voice => voice.name === 'Microsoft Maria - Portuguese (Brazil)');
      synth.speak(utter);
    }

    function startRecognition() {
      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
      if (!SpeechRecognition) {
        alert("Seu navegador não suporta reconhecimento de voz.");
        return;
      }

      const recognition = new SpeechRecognition();
      recognition.lang = 'pt-BR';
      recognition.start();

      recognition.onresult = (event) => {
        const userText = event.results[0][0].transcript;
        output.textContent = `Você disse: "${userText}"`;
        responderNatália(userText);
      };

      recognition.onerror = (event) => {
        output.textContent = "Erro no reconhecimento de voz: " + event.error;
      };
    }

    function responderNatália(frase) {
      let resposta = "Não entendi bem, pode repetir?";
      const texto = frase.toLowerCase();

      if (texto.includes("inchaço") || texto.includes("inchada") || texto.includes("barriga") || texto.includes("estufada")) {
        resposta = "Ah, entendi! O inchaço abdominal é bem comum. Recomendo o nosso Kit Detox com chá de hortelã, sene e granola com cúrcuma.";
      } else if (texto.includes("ansiedade") || texto.includes("ansioso") || texto.includes("nervoso") || texto.includes("preocupado")) {
        resposta = "Entendi, ansiedade pode ser bem difícil. Sugiro o Kit Relax com chá de camomila, melissa e lavanda.";
      } else if (texto.includes("sono") || texto.includes("insônia") || texto.includes("dormir") || texto.includes("acordando")) {
        resposta = "Para melhorar seu sono, temos um kit natural com chá de maracujá, mulungu e mel puro. Pode te ajudar a relaxar.";
      }

      speak(resposta);
      output.textContent += `\nNatália: ${resposta}`;
    }

    window.onload = () => speak("Oi! Eu sou a Natália, sua consultora da RedeNutri. Me diga como posso te ajudar hoje?");
  </script>
</body>
</html>
